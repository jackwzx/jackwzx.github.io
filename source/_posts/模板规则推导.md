---
title: 模板规则推导
date: 2023-12-21 13:56:09
tags:
---

### 模板推导规则

```
template<typename T>
void passByRefFun(T& val) { }

template<typename T>
void passByUniRefFun(T&& val) { }

template<typename T>
void passByValueFun(T val) { }

void fun3(int& a) { }
void fun3(int&& a) { }

void test()
{
    int a = 0;          //a int
    const int b = a;    //b const int
    const int& c = a;   //c const int&
    
    passByRefFun(a);    // int&
    passByRefFun(b);    // const int&
    passByRefFun(c);    // const int&
    //passByRefFun(27);   // 报错
    
    passByUniRefFun(a); // int&
    passByUniRefFun(b); // const int&
    passByUniRefFun(c); // const int&
    passByUniRefFun(27); // int&&
    
    passByValueFun(a);  // int
    passByValueFun(b);  // int
    passByValueFun(c);  // int
    passByValueFun(27); // int
    
    {
        int&& a = 10;
        fun3(a);            // called void fun3(int& a)
        fun3(std::move(a)); // called void fun3(int&& a)
        
    }
}
```


### SFINAE
SFINAE（Substitution Failure Is Not An Error）是 C++ 中的一个重要概念，主要用于模板编程。它的意思是，当模板参数替换导致错误时，编译器不会将其视为错误，而是会继续查找其他可能的匹配。这使得我们可以在模板中进行条件编译，选择合适的重载或特化

SFINAE 的优势
条件编译：可以根据类型特征选择不同的实现，增强代码的灵活性和可重用性。
避免编译错误：当模板参数替换导致错误时，编译器不会将其视为错误，而是继续查找其他匹配的模板。
类型安全：通过类型特征，可以确保只有符合条件的类型才能使用特定的模板实现。


SFINAE 是 C++ 模板编程中的一个强大工具，允许开发者根据类型特征选择合适的模板特化或重载。通过结合 std::enable_if 和类型特征，开发者可以编写更灵活和安全的代码。